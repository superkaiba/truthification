<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Factor Experiment Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0; padding: 20px; background: #0d1117; color: #c9d1d9;
        }
        .container { max-width: 1400px; margin: 0 auto; }
        h1 { color: #58a6ff; border-bottom: 2px solid #30363d; padding-bottom: 10px; }
        h2 { color: #8b949e; margin-top: 30px; }
        .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin: 20px 0; }
        .card { background: #161b22; border: 1px solid #30363d; border-radius: 6px; padding: 15px; }
        .card h3 { margin-top: 0; color: #58a6ff; font-size: 14px; }
        .metric { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #21262d; font-size: 13px; }
        .metric:last-child { border-bottom: none; }
        .metric-value { font-weight: bold; color: #7ee787; }
        .metric-value.warn { color: #d29922; }
        .chart-container { background: #161b22; border: 1px solid #30363d; border-radius: 6px; padding: 15px; margin: 15px 0; }
        .tabs { display: flex; gap: 5px; margin-bottom: 15px; flex-wrap: wrap; }
        .tab { padding: 8px 16px; background: #21262d; border: 1px solid #30363d; border-radius: 6px; cursor: pointer; color: #8b949e; font-size: 13px; }
        .tab:hover { background: #30363d; }
        .tab.active { background: #238636; color: white; border-color: #238636; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        select { padding: 8px; background: #21262d; border: 1px solid #30363d; border-radius: 6px; color: #c9d1d9; margin: 5px; }
        .finding { background: #161b22; border-left: 3px solid #58a6ff; padding: 12px; margin: 10px 0; border-radius: 0 6px 6px 0; }
        .finding.good { border-color: #238636; }
        .finding.bad { border-color: #da3633; }
        .finding.warn { border-color: #d29922; }
        table { width: 100%; border-collapse: collapse; font-size: 12px; }
        th, td { padding: 8px; text-align: left; border-bottom: 1px solid #21262d; }
        th { background: #21262d; color: #58a6ff; }
        tr:hover { background: #21262d; }
    </style>
</head>
<body>
<div class="container">
    <h1>Multi-Factor Experiment Analysis</h1>
    <p>179 games | 53.3 hours | 36 conditions x 5 seeds | 10 rounds per game</p>

    <div class="tabs">
        <button class="tab active" onclick="showTab('overview')">Overview</button>
        <button class="tab" onclick="showTab('factors')">Factors</button>
        <button class="tab" onclick="showTab('trajectories')">Trajectories</button>
        <button class="tab" onclick="showTab('findings')">Findings</button>
    </div>

    <div id="overview" class="tab-content active">
        <div class="summary-grid">
            <div class="card">
                <h3>BY OBSERVER CONDITION</h3>
                <div class="metric"><span>blind</span><span class="metric-value">52.8% prop acc</span></div>
                <div class="metric"><span>ids</span><span class="metric-value warn">50.4% prop acc</span></div>
                <div class="metric"><span>interests</span><span class="metric-value">55.1% prop acc</span></div>
            </div>
            <div class="card">
                <h3>BY ORACLE TYPE</h3>
                <div class="metric"><span>Strategic</span><span class="metric-value">148.5 value, 49.3% acc</span></div>
                <div class="metric"><span>Random</span><span class="metric-value">116.1 value, 56.2% acc</span></div>
            </div>
            <div class="card">
                <h3>BY RULE COMPLEXITY</h3>
                <div class="metric"><span>Simple</span><span class="metric-value">47.9% prop, 62.7% rule</span></div>
                <div class="metric"><span>Medium</span><span class="metric-value warn">47.0% prop, 51.5% rule</span></div>
                <div class="metric"><span>Complex</span><span class="metric-value">63.3% prop, 38.5% rule</span></div>
            </div>
            <div class="card">
                <h3>ESTIMATOR VS BASELINE</h3>
                <div class="metric"><span>Estimator accuracy</span><span class="metric-value warn">32.1%</span></div>
                <div class="metric"><span>Random baseline</span><span class="metric-value warn">30.7%</span></div>
                <div class="metric"><span>Delta</span><span class="metric-value warn">+1.4%</span></div>
            </div>
        </div>
        <div class="chart-container"><div id="overview-chart"></div></div>
    </div>

    <div id="factors" class="tab-content">
        <div class="chart-container"><div id="observer-chart"></div></div>
        <div class="chart-container"><div id="oracle-chart"></div></div>
        <div class="chart-container"><div id="complexity-chart"></div></div>
    </div>

    <div id="trajectories" class="tab-content">
        <div style="margin-bottom:15px;">
            <select id="traj-condition" onchange="updateTrajectory()"></select>
        </div>
        <div class="chart-container"><div id="value-trajectory"></div></div>
        <div class="chart-container"><div id="accuracy-trajectory"></div></div>
        <div class="chart-container"><div id="agent-trajectory"></div></div>
    </div>

    <div id="findings" class="tab-content">
        <div class="finding good">
            <strong>1. Knowing agent interests helps marginally</strong><br>
            interests (55.1%) > blind (52.8%) > ids (50.4%). Just knowing IDs doesn't help - need to know what they want.
        </div>
        <div class="finding warn">
            <strong>2. Random Oracle Paradox</strong><br>
            Random oracle has HIGHER property accuracy (56.2%) than strategic (49.3%), but LOWER value (116 vs 148).
            Strategic optimizes for selection, not truth coverage.
        </div>
        <div class="finding bad">
            <strong>3. Estimator barely beats random</strong><br>
            32.1% vs 30.7% baseline. Passive observation of strategic agents yields minimal truth recovery.
        </div>
        <div class="finding good">
            <strong>4. Complex rules + Complex VF = best property accuracy</strong><br>
            *_complex_complex conditions achieve 74-79% property accuracy. More conditions = more statements about properties.
        </div>
        <div class="finding warn">
            <strong>5. Rule complexity trade-off</strong><br>
            Complex rules: 63.3% prop acc but only 38.5% rule inference.<br>
            Simple rules: 47.9% prop acc but 62.7% rule inference.
        </div>
    </div>
</div>

<script>
const trajectoryData = {"blind_oracle-strategic_vf-simple_simple": {"cumulative_value": [55.4, 82.4, 116, 154.8, 183, 183, 183, 183, 183, 183], "value_per_round": [55.4, 27, 33.6, 38.8, 28.2, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.4, 0.8, 1.2, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6], "agent_b_cumulative": [0.4, 0.6, 1, 1, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4], "n_games": 5}, "blind_oracle-strategic_vf-simple_medium": {"cumulative_value": [48.6, 80.6, 111, 131.2, 166.8, 166.8, 166.8, 166.8, 166.8, 166.8], "value_per_round": [48.6, 32, 30.4, 20.2, 35.6, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.6, 0.8, 1, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6], "agent_b_cumulative": [0.2, 0.8, 1.2, 1.2, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4], "n_games": 5}, "blind_oracle-strategic_vf-simple_complex": {"cumulative_value": [25.4, 55.6, 87.2, 103, 118.6, 118.6, 118.6, 118.6, 118.6, 118.6], "value_per_round": [25.4, 30.2, 31.6, 15.8, 15.6, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.8, 1.2, 1.4, 1.4, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6], "agent_b_cumulative": [0, 0.2, 0.4, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6], "n_games": 5}, "blind_oracle-strategic_vf-complex_simple": {"cumulative_value": [40.6, 102.4, 141.4, 146.6, 178.2, 178.2, 178.2, 178.2, 178.2, 178.2], "value_per_round": [40.6, 61.8, 39, 5.2, 31.6, 0, 0, 0, 0, 0], "agent_a_cumulative": [0, 26, 45, 64, 85, 85, 85, 85, 85, 85], "agent_b_cumulative": [18, 25, 42, 55, 70, 70, 70, 70, 70, 70], "n_games": 5}, "blind_oracle-strategic_vf-complex_medium": {"cumulative_value": [26, 72.4, 104.6, 134.4, 160.2, 160.2, 160.2, 160.2, 160.2, 160.2], "value_per_round": [26, 46.4, 32.2, 29.8, 25.8, 0, 0, 0, 0, 0], "agent_a_cumulative": [31, 46, 67, 81, 97, 97, 97, 97, 97, 97], "agent_b_cumulative": [26, 48, 62, 78, 100, 100, 100, 100, 100, 100], "n_games": 5}, "blind_oracle-strategic_vf-complex_complex": {"cumulative_value": [27, 48, 68.4, 96.4, 116.8, 116.8, 116.8, 116.8, 116.8, 116.8], "value_per_round": [27, 21, 20.4, 28, 20.4, 0, 0, 0, 0, 0], "agent_a_cumulative": [10, 33, 64, 89, 101, 101, 101, 101, 101, 101], "agent_b_cumulative": [25, 39, 68, 80, 102, 102, 102, 102, 102, 102], "n_games": 5}, "blind_oracle-random_vf-simple_simple": {"cumulative_value": [40, 56.6, 85.6, 128.4, 157, 157, 157, 157, 157, 157], "value_per_round": [40, 16.6, 29, 42.8, 28.6, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.4, 0.4, 1, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4], "agent_b_cumulative": [0.2, 0.4, 0.4, 0.4, 0.6, 0.6, 0.6, 0.6, 0.6, 0.6], "n_games": 5}, "blind_oracle-random_vf-simple_medium": {"cumulative_value": [23.2, 38.6, 52.4, 89, 116.6, 116.6, 116.6, 116.6, 116.6, 116.6], "value_per_round": [23.2, 15.4, 13.8, 36.6, 27.6, 0, 0, 0, 0, 0], "agent_a_cumulative": [0, 0, 0.2, 0.6, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "agent_b_cumulative": [0.6, 1, 1, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "n_games": 5}, "blind_oracle-random_vf-simple_complex": {"cumulative_value": [14, 48.4, 65.4, 93.6, 113, 113, 113, 113, 113, 113], "value_per_round": [14, 34.4, 17, 28.2, 19.4, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.4, 0.6, 0.8, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "agent_b_cumulative": [0.2, 0.4, 0.6, 0.6, 1, 1, 1, 1, 1, 1], "n_games": 5}, "blind_oracle-random_vf-complex_simple": {"cumulative_value": [30.6, 44, 56.2, 96.8, 116, 116, 116, 116, 116, 116], "value_per_round": [30.6, 13.4, 12.2, 40.6, 19.2, 0, 0, 0, 0, 0], "agent_a_cumulative": [12, 32, 41, 58, 76, 76, 76, 76, 76, 76], "agent_b_cumulative": [13, 29, 54, 61, 85, 85, 85, 85, 85, 85], "n_games": 5}, "blind_oracle-random_vf-complex_medium": {"cumulative_value": [28.8, 45.4, 59.4, 81.8, 119.2, 119.2, 119.2, 119.2, 119.2, 119.2], "value_per_round": [28.8, 16.6, 14, 22.4, 37.4, 0, 0, 0, 0, 0], "agent_a_cumulative": [8, 27, 48, 66, 76, 76, 76, 76, 76, 76], "agent_b_cumulative": [20, 38, 64, 84, 100, 100, 100, 100, 100, 100], "n_games": 5}, "blind_oracle-random_vf-complex_complex": {"cumulative_value": [16.2, 37.4, 38.2, 55.6, 80.8, 80.8, 80.8, 80.8, 80.8, 80.8], "value_per_round": [16.2, 21.2, 0.8, 17.4, 25.2, 0, 0, 0, 0, 0], "agent_a_cumulative": [8, 35, 51, 57, 72, 72, 72, 72, 72, 72], "agent_b_cumulative": [22, 39, 70, 82, 105, 105, 105, 105, 105, 105], "n_games": 5}, "ids_oracle-strategic_vf-simple_simple": {"cumulative_value": [52.2, 94, 133, 160.4, 180.8, 180.8, 180.8, 180.8, 180.8, 180.8], "value_per_round": [52.2, 41.8, 39, 27.4, 20.4, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.4, 0.8, 1.2, 1.2, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4], "agent_b_cumulative": [0.4, 0.6, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8], "n_games": 5}, "ids_oracle-strategic_vf-simple_medium": {"cumulative_value": [43.4, 63.4, 101.4, 126, 153.2, 153.2, 153.2, 153.2, 153.2, 153.2], "value_per_round": [43.4, 20, 38, 24.6, 27.2, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.2, 0.6, 0.6, 1, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "agent_b_cumulative": [0.6, 0.8, 0.8, 0.8, 1, 1, 1, 1, 1, 1], "n_games": 5}, "ids_oracle-strategic_vf-simple_complex": {"cumulative_value": [26.2, 46, 70.6, 87, 108, 108, 108, 108, 108, 108], "value_per_round": [26.2, 19.8, 24.6, 16.4, 21, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.2, 1, 1.4, 1.8, 1.8, 1.8, 1.8, 1.8, 1.8, 1.8], "agent_b_cumulative": [0.6, 0.6, 0.8, 1, 1, 1, 1, 1, 1, 1], "n_games": 5}, "ids_oracle-strategic_vf-complex_simple": {"cumulative_value": [21.8, 72.4, 122.6, 146.8, 165.4, 165.4, 165.4, 165.4, 165.4, 165.4], "value_per_round": [21.8, 50.6, 50.2, 24.2, 18.6, 0, 0, 0, 0, 0], "agent_a_cumulative": [22, 42, 60, 76, 97, 97, 97, 97, 97, 97], "agent_b_cumulative": [24, 38, 49, 75, 100, 100, 100, 100, 100, 100], "n_games": 5}, "ids_oracle-strategic_vf-complex_medium": {"cumulative_value": [56.25, 86, 107.5, 139, 159.5, 159.5, 159.5, 159.5, 159.5, 159.5], "value_per_round": [56.25, 29.75, 21.5, 31.5, 20.5, 0, 0, 0, 0, 0], "agent_a_cumulative": [22.5, 50, 65, 87.5, 102.5, 102.5, 102.5, 102.5, 102.5, 102.5], "agent_b_cumulative": [16.25, 48.75, 48.75, 63.75, 93.75, 93.75, 93.75, 93.75, 93.75, 93.75], "n_games": 4}, "ids_oracle-strategic_vf-complex_complex": {"cumulative_value": [25.4, 31.6, 54, 67.6, 91.6, 91.6, 91.6, 91.6, 91.6, 91.6], "value_per_round": [25.4, 6.2, 22.4, 13.6, 24, 0, 0, 0, 0, 0], "agent_a_cumulative": [25, 42, 54, 72, 86, 86, 86, 86, 86, 86], "agent_b_cumulative": [24, 42, 64, 86, 101, 101, 101, 101, 101, 101], "n_games": 5}, "ids_oracle-random_vf-simple_simple": {"cumulative_value": [28.6, 33.4, 64, 81.6, 119.4, 119.4, 119.4, 119.4, 119.4, 119.4], "value_per_round": [28.6, 4.8, 30.6, 17.6, 37.8, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.2, 0.2, 0.6, 1, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "agent_b_cumulative": [0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4], "n_games": 5}, "ids_oracle-random_vf-simple_medium": {"cumulative_value": [36.6, 56.8, 89.2, 105.4, 119, 119, 119, 119, 119, 119], "value_per_round": [36.6, 20.2, 32.4, 16.2, 13.6, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.4, 0.6, 0.8, 1, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "agent_b_cumulative": [0, 0.2, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4, 0.4], "n_games": 5}, "ids_oracle-random_vf-simple_complex": {"cumulative_value": [-0.4, 50.2, 57.2, 77.6, 95.4, 95.4, 95.4, 95.4, 95.4, 95.4], "value_per_round": [-0.4, 50.6, 7, 20.4, 17.8, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.2, 0.4, 0.8, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "agent_b_cumulative": [0.2, 0.2, 0.4, 0.6, 1, 1, 1, 1, 1, 1], "n_games": 5}, "ids_oracle-random_vf-complex_simple": {"cumulative_value": [29.6, 47, 74, 105.8, 131.8, 131.8, 131.8, 131.8, 131.8, 131.8], "value_per_round": [29.6, 17.4, 27, 31.8, 26, 0, 0, 0, 0, 0], "agent_a_cumulative": [21, 35, 57, 65, 84, 84, 84, 84, 84, 84], "agent_b_cumulative": [20, 29, 60, 74, 83, 83, 83, 83, 83, 83], "n_games": 5}, "ids_oracle-random_vf-complex_medium": {"cumulative_value": [12, 42.8, 63.2, 88.4, 125.8, 125.8, 125.8, 125.8, 125.8, 125.8], "value_per_round": [12, 30.8, 20.4, 25.2, 37.4, 0, 0, 0, 0, 0], "agent_a_cumulative": [21, 26, 46, 60, 70, 70, 70, 70, 70, 70], "agent_b_cumulative": [22, 53, 69, 81, 97, 97, 97, 97, 97, 97], "n_games": 5}, "ids_oracle-random_vf-complex_complex": {"cumulative_value": [11.8, 40.2, 69.2, 95, 115.4, 115.4, 115.4, 115.4, 115.4, 115.4], "value_per_round": [11.8, 28.4, 29, 25.8, 20.4, 0, 0, 0, 0, 0], "agent_a_cumulative": [12, 34, 57, 67, 79, 79, 79, 79, 79, 79], "agent_b_cumulative": [15, 37, 66, 71, 94, 94, 94, 94, 94, 94], "n_games": 5}, "interests_oracle-strategic_vf-simple_simple": {"cumulative_value": [42.2, 80.8, 128.8, 140.2, 157.6, 157.6, 157.6, 157.6, 157.6, 157.6], "value_per_round": [42.2, 38.6, 48, 11.4, 17.4, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.6, 1, 1, 1, 1, 1, 1, 1, 1, 1], "agent_b_cumulative": [0.2, 0.4, 0.6, 1, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "n_games": 5}, "interests_oracle-strategic_vf-simple_medium": {"cumulative_value": [46, 81.6, 112.2, 135.6, 155.6, 155.6, 155.6, 155.6, 155.6, 155.6], "value_per_round": [46, 35.6, 30.6, 23.4, 20, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.6, 1.2, 1.2, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6, 1.6], "agent_b_cumulative": [0.2, 0.4, 0.8, 1, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "n_games": 5}, "interests_oracle-strategic_vf-simple_complex": {"cumulative_value": [27.8, 60.2, 81.2, 91.6, 119, 119, 119, 119, 119, 119], "value_per_round": [27.8, 32.4, 21, 10.4, 27.4, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.4, 1, 1.4, 1.8, 1.8, 1.8, 1.8, 1.8, 1.8, 1.8], "agent_b_cumulative": [0.4, 0.4, 0.6, 1, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "n_games": 5}, "interests_oracle-strategic_vf-complex_simple": {"cumulative_value": [27.8, 77.4, 120.6, 146.4, 176.2, 176.2, 176.2, 176.2, 176.2, 176.2], "value_per_round": [27.8, 49.6, 43.2, 25.8, 29.8, 0, 0, 0, 0, 0], "agent_a_cumulative": [22, 40, 62, 74, 78, 78, 78, 78, 78, 78], "agent_b_cumulative": [24, 35, 47, 71, 78, 78, 78, 78, 78, 78], "n_games": 5}, "interests_oracle-strategic_vf-complex_medium": {"cumulative_value": [33.2, 67.6, 107.2, 136.4, 164, 164, 164, 164, 164, 164], "value_per_round": [33.2, 34.4, 39.6, 29.2, 27.6, 0, 0, 0, 0, 0], "agent_a_cumulative": [23, 32, 54, 62, 70, 70, 70, 70, 70, 70], "agent_b_cumulative": [26, 42, 58, 76, 98, 98, 98, 98, 98, 98], "n_games": 5}, "interests_oracle-strategic_vf-complex_complex": {"cumulative_value": [36.8, 53.6, 94.4, 103.8, 118.6, 118.6, 118.6, 118.6, 118.6, 118.6], "value_per_round": [36.8, 16.8, 40.8, 9.4, 14.8, 0, 0, 0, 0, 0], "agent_a_cumulative": [23, 45, 63, 80, 93, 93, 93, 93, 93, 93], "agent_b_cumulative": [31, 56, 65, 83, 95, 95, 95, 95, 95, 95], "n_games": 5}, "interests_oracle-random_vf-simple_simple": {"cumulative_value": [41.2, 66.8, 97.2, 117, 146.2, 146.2, 146.2, 146.2, 146.2, 146.2], "value_per_round": [41.2, 25.6, 30.4, 19.8, 29.2, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.4, 0.6, 0.8, 1.2, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4], "agent_b_cumulative": [0.4, 0.4, 0.6, 0.6, 0.8, 0.8, 0.8, 0.8, 0.8, 0.8], "n_games": 5}, "interests_oracle-random_vf-simple_medium": {"cumulative_value": [28.6, 40.8, 73.4, 109.2, 127.8, 127.8, 127.8, 127.8, 127.8, 127.8], "value_per_round": [28.6, 12.2, 32.6, 35.8, 18.6, 0, 0, 0, 0, 0], "agent_a_cumulative": [0.4, 0.4, 0.6, 1.2, 1.4, 1.4, 1.4, 1.4, 1.4, 1.4], "agent_b_cumulative": [0, 0.4, 0.8, 0.8, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "n_games": 5}, "interests_oracle-random_vf-simple_complex": {"cumulative_value": [-10.6, 18, 47.8, 48, 59.2, 59.2, 59.2, 59.2, 59.2, 59.2], "value_per_round": [-10.6, 28.6, 29.8, 0.2, 11.2, 0, 0, 0, 0, 0], "agent_a_cumulative": [0, 0.4, 1, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "agent_b_cumulative": [0.6, 0.8, 0.8, 1, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2], "n_games": 5}, "interests_oracle-random_vf-complex_simple": {"cumulative_value": [26.2, 40, 71.6, 92.2, 118.6, 118.6, 118.6, 118.6, 118.6, 118.6], "value_per_round": [26.2, 13.8, 31.6, 20.6, 26.4, 0, 0, 0, 0, 0], "agent_a_cumulative": [17, 31, 43, 51, 72, 72, 72, 72, 72, 72], "agent_b_cumulative": [27, 38, 62, 74, 86, 86, 86, 86, 86, 86], "n_games": 5}, "interests_oracle-random_vf-complex_medium": {"cumulative_value": [33.2, 57.6, 82.2, 97.6, 123.2, 123.2, 123.2, 123.2, 123.2, 123.2], "value_per_round": [33.2, 24.4, 24.6, 15.4, 25.6, 0, 0, 0, 0, 0], "agent_a_cumulative": [18, 32, 44, 54, 74, 74, 74, 74, 74, 74], "agent_b_cumulative": [22, 38, 53, 70, 88, 88, 88, 88, 88, 88], "n_games": 5}, "interests_oracle-random_vf-complex_complex": {"cumulative_value": [-6.6, 38.8, 64.4, 85.6, 106, 106, 106, 106, 106, 106], "value_per_round": [-6.6, 45.4, 25.6, 21.2, 20.4, 0, 0, 0, 0, 0], "agent_a_cumulative": [12, 30, 55, 73, 99, 99, 99, 99, 99, 99], "agent_b_cumulative": [12, 38, 61, 74, 94, 94, 94, 94, 94, 94], "n_games": 5}};
const overallTrajectory = {"cumulative_value": [28.877094972067038, 57.02793296089386, 85.22905027932961, 108.04469273743017, 132.16759776536313, 132.16759776536313, 132.16759776536313, 132.16759776536313, 132.16759776536313, 132.16759776536313], "agent_a_cumulative": [8.64804469273743, 17.877094972067038, 27.374301675977655, 34.6927374301676, 42.3463687150838, 42.3463687150838, 42.3463687150838, 42.3463687150838, 42.3463687150838, 42.3463687150838], "agent_b_cumulative": [10.88268156424581, 19.88826815642458, 29.75977653631285, 37.44134078212291, 46.608938547486034, 46.608938547486034, 46.608938547486034, 46.608938547486034, 46.608938547486034, 46.608938547486034]};
const accuracyProgression = {"judge_prop_acc": [7.06145251396648, 11.273743016759777, 13.82122905027933, 16.905027932960895, 19.70949720670391, 20.681564245810055, 21.810055865921786, 23.45251396648045, 23.81005586592179, 23.88826815642458], "judge_rule_acc": [49.534450651769085, 47.746741154562386, 48.04469273743017, 46.59217877094972, 44.3389199255121, 44.46927374301676, 42.88640595903166, 44.50651769087523, 46.83426443202979, 41.340782122905026], "est_prop_acc": [7.039106145251396, 12.12290502793296, 16.502793296089386, 20.63687150837989, 24.491620111731844, 27.69832402234637, 29.374301675977655, 30.6927374301676, 31.497206703910614, 32.05586592178771], "est_rule_acc": [1.3966480446927376, 0.9124767225325885, 0.8858739026336792, 0.4655493482309125, 0.27932960893854747, 0.27932960893854747, 0.27932960893854747, 0.27932960893854747, 0.27932960893854747, 0.27932960893854747]};

const plotlyConfig = {responsive: true};
const plotlyLayout = {
    paper_bgcolor: '#161b22',
    plot_bgcolor: '#161b22',
    font: {color: '#c9d1d9'},
    xaxis: {gridcolor: '#21262d'},
    yaxis: {gridcolor: '#21262d'}
};

function showTab(id) {
    document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    event.target.classList.add('active');
}

function initCharts() {
    // Overview - top conditions by prop accuracy
    const conditions = Object.keys(trajectoryData);
    const select = document.getElementById('traj-condition');
    select.innerHTML = '<option value="overall">Overall Average</option>';
    conditions.forEach(c => {
        const opt = document.createElement('option');
        opt.value = c; opt.textContent = c;
        select.appendChild(opt);
    });

    // Overview chart - sorted by final cumulative value
    const sortedConds = conditions.slice().sort((a, b) => {
        const aVal = trajectoryData[a].cumulative_value[4] || 0;
        const bVal = trajectoryData[b].cumulative_value[4] || 0;
        return bVal - aVal;
    });

    Plotly.newPlot('overview-chart', [{
        x: sortedConds.map(c => c.substring(0, 30)),
        y: sortedConds.map(c => trajectoryData[c].cumulative_value[4] || 0),
        type: 'bar',
        marker: {color: sortedConds.map(c => trajectoryData[c].cumulative_value[4] > 150 ? '#238636' : '#d29922')}
    }], {...plotlyLayout, title: 'Final Value by Condition (Round 5)', xaxis: {...plotlyLayout.xaxis, tickangle: -45}, margin: {b: 150}}, plotlyConfig);

    // Factor charts
    Plotly.newPlot('observer-chart', [
        {x: ['blind', 'ids', 'interests'], y: [52.8, 50.4, 55.1], name: 'Prop Acc', type: 'bar'},
        {x: ['blind', 'ids', 'interests'], y: [31.1, 31.6, 33.4], name: 'Est Prop Acc', type: 'bar'}
    ], {...plotlyLayout, title: 'By Observer Condition', barmode: 'group'}, plotlyConfig);

    Plotly.newPlot('oracle-chart', [
        {x: ['Strategic', 'Random'], y: [148.5, 116.1], name: 'Value', type: 'bar'},
        {x: ['Strategic', 'Random'], y: [49.3, 56.2], name: 'Prop Acc', type: 'bar', yaxis: 'y2'}
    ], {...plotlyLayout, title: 'Strategic vs Random Oracle', yaxis2: {overlaying: 'y', side: 'right', gridcolor: '#21262d'}}, plotlyConfig);

    Plotly.newPlot('complexity-chart', [
        {x: ['simple', 'medium', 'complex'], y: [47.9, 47.0, 63.3], name: 'Prop Acc', type: 'bar'},
        {x: ['simple', 'medium', 'complex'], y: [62.7, 51.5, 38.5], name: 'Rule Acc', type: 'bar'}
    ], {...plotlyLayout, title: 'By Rule Complexity', barmode: 'group'}, plotlyConfig);

    // Initial trajectory
    updateTrajectory();
}

function updateTrajectory() {
    const cond = document.getElementById('traj-condition').value;
    const rounds = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    
    let data = cond === 'overall' ? overallTrajectory : trajectoryData[cond];
    if (!data) data = overallTrajectory;

    // Value trajectory
    Plotly.newPlot('value-trajectory', [{
        x: rounds, y: data.cumulative_value,
        name: 'Cumulative Value', mode: 'lines+markers',
        line: {color: '#58a6ff'}
    }], {...plotlyLayout, title: 'Cumulative Value Over Rounds', xaxis: {...plotlyLayout.xaxis, title: 'Round'}, yaxis: {...plotlyLayout.yaxis, title: 'Value'}}, plotlyConfig);

    // Accuracy trajectory (use overall)
    Plotly.newPlot('accuracy-trajectory', [
        {x: rounds, y: accuracyProgression.judge_prop_acc, name: 'Judge Prop Acc', mode: 'lines+markers', line: {color: '#58a6ff'}},
        {x: rounds, y: accuracyProgression.est_prop_acc, name: 'Estimator Prop Acc', mode: 'lines+markers', line: {color: '#7ee787'}},
        {x: rounds, y: rounds.map(() => 30.7), name: 'Random Baseline', mode: 'lines', line: {dash: 'dash', color: '#da3633'}}
    ], {...plotlyLayout, title: 'Accuracy Progression Over Rounds', xaxis: {...plotlyLayout.xaxis, title: 'Round'}, yaxis: {...plotlyLayout.yaxis, title: 'Accuracy (%)'}}, plotlyConfig);

    // Agent trajectory
    Plotly.newPlot('agent-trajectory', [
        {x: rounds, y: data.agent_a_cumulative, name: 'Agent A', mode: 'lines+markers', line: {color: '#f85149'}},
        {x: rounds, y: data.agent_b_cumulative, name: 'Agent B', mode: 'lines+markers', line: {color: '#a371f7'}}
    ], {...plotlyLayout, title: 'Agent Cumulative Values Over Rounds', xaxis: {...plotlyLayout.xaxis, title: 'Round'}, yaxis: {...plotlyLayout.yaxis, title: 'Agent Value'}}, plotlyConfig);
}

document.addEventListener('DOMContentLoaded', initCharts);
</script>
</body>
</html>